{% extends "base.html" %}


{% block first_content %}

    <p><img src="{{ MEDIA_URL}}{{ object.image }}"></p>
    <p>{{ object.first_name }} {{ object.last_name }}</p>
    <p>{{ object.about_me  }}</p>
    <p>{{ object.website_url }}</p>
    <p>{{ object.blog_url }}</p>
    <p>{{ object.facebook_profile_url }}
    <p>{{ object.date_of_birth }}</p>
    <p>{{ object.website_url }}</p>
    <p>{{ object.supports.all.count }} adayı destekliyor</p>
    <p>{{ object.supporters.all.count }} aday tarafından destekleniyor</p>
    
    <p>
		{% for tag in object.tags.all %}
			<a class="label" href="{% url "profile_list" %}?tag={{tag.name}}">{{tag.name}}</a>
		{% endfor %}
    </p>
    <input class="username" type="hidden" data-username="{{ object.username }}">

	{% if not user == object %}
		<div id="id_div_unsupport" {% if not object in user.supports.all %}style="display:none"{% endif %}>
		    Bu adayı destekliyorsun! 
		    <a class="support" data-username="{{ object.username }}" data-support="-">desteğini çek</a>
		</div>
		<div id="id_div_support" {% if object in user.supports.all %}style="display:none"{% endif %}>
		    <a class="btn support" id="btn_destek" data-username="{{ object.username }}" data-support="+">Beni temsil eder!</a>
		</div>
	{% endif %}

{% endblock %}


{% block footer %}
    <script>
    $(function () {

	    $('.support').click(function(){
	    	var username = $(this).data('username');
	    	var support = $(this).data('support');
	        $.ajax({
	            url:"{% url "profile_support" %}",
	            type:"POST",
	            data:{"username":username, 'csrfmiddlewaretoken': '{{csrf_token}}', "support": support},
	            dataType:"json",
	            complete: function(data){
	            	if (data.responseText == '+') {
		            	$('#id_div_support').hide();
		            	$('#id_div_unsupport').show();
	            	} else if (data.responseText == '-') {
		            	$('#id_div_unsupport').hide();
		            	$('#id_div_support').show();
	            	} else if (data.responseText == '0') {
		            	console.log(data);
	            	}
	            }
	         })
	    })

    });
    </script>
{% endblock %}
